<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>

    <link rel="stylesheet" href="https://unnpkg.com/leaflet/dist/leaflet.css">

  <style>
    body{
        text-align: center;
        font-family: sans-serif;
    }
    #map{
        height: 400px;
        width: 100%;
        margin-top: 20px;
    }
  </style>

</head>
<body>
    <h2>Weather App</h2>
    <input type="text" placeholder="Enter city name" id="city">
    <button onclick="getWeather()">Get  Weather</button>
    <div id="result"></div>
    <div id="map"></div>

<script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>

    <script>
        let map;

      async function getWeather(){
        const city =  document.querySelector('#city').value;
        const apiKey = 'a23b75afeab12e25760cd18c9f71c990'
        const url = `https://api.openweathermap.org/data/2.5/weather?q=${city}&appid=${apiKey}&units=metric`;

        try{
            const res = await fetch(url);
            if(!res.ok) throw new Error("City Not Found");
            const data  = await res.json()

            // const name  = data.name;
            const {name} = data;
            const {temp} = data.main;
            const {lat , lon} = data.coord;

             document.getElementById('result').innerHTML = `
              <h2>${name}</h2>
              <p>${temp}</p>
             ` ;

         if(!map){
            var map = L.map('map').setView([lat , lon], 13);

L.tileLayer('https://tile.openstreetmap.org/{z}/{x}/{y}.png', {
    attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'
}).addTo(map);

         }else{
            map.setView([lat,lon],13)
         }
            L.marker([lat,lon]).addTo(map).bindPopup(`${name}:${temp}`).openPopup();

        }catch(err){
             document.getElementById('result').innerHTML =  'Error'
            
        }
        
      }
    </script>
</body>
</html>